var J=Object.defineProperty;var P=Object.getOwnPropertySymbols;var Q=Object.prototype.hasOwnProperty,Z=Object.prototype.propertyIsEnumerable;var O=(s,e,t)=>e in s?J(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,U=(s,e)=>{for(var t in e||(e={}))Q.call(e,t)&&O(s,t,e[t]);if(P)for(var t of P(e))Z.call(e,t)&&O(s,t,e[t]);return s};import{r as X,c as v,a as k,o as _,b as p,d as r,e as h,F as M,f as ee,S as D,u as te,g as oe,t as y,h as q,i as re,w as f,j as se,k as ae,l as ne,M as ie,m as ce,n as w,v as C,p as le,q as N,s as de,x as ue,y as _e,z as me,A as pe,B as he,C as S,D as fe}from"./vendor.0842eb63.js";const be=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))o(n);new MutationObserver(n=>{for(const c of n)if(c.type==="childList")for(const l of c.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&o(l)}).observe(document,{childList:!0,subtree:!0});function t(n){const c={};return n.integrity&&(c.integrity=n.integrity),n.referrerpolicy&&(c.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?c.credentials="include":n.crossorigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function o(n){if(n.ep)return;n.ep=!0;const c=t(n);fetch(n.href,c)}};be();const a=X({user:{},account:{},cars:[],bids:[],myBids:[],activeCar:{}});var x=(s,e)=>{for(const[t,o]of e)s[t]=o;return s};const ge={name:"App",setup(){return{appState:v(()=>a)}}},ve={class:"container-fluid d-flex w-100"},ye={class:"row flex-grow-1"},we={class:"col-2 p-0 h-100"},Ce={class:"col-10"},xe=r("footer",null,[r("div",{class:"bg-dark text-light text-center p-4"}," Made with \u{1F496} by CodeWorks ")],-1);function ke(s,e,t,o,n,c){const l=k("Navbar"),i=k("router-view");return _(),p(M,null,[r("main",ve,[r("div",ye,[r("div",we,[h(l)]),r("div",Ce,[h(i)])])]),xe],64)}var $e=x(ge,[["render",ke]]);class R{constructor(e){this.bidId=e.id,this.accountId=e.accountId,this.carId=e.carId,this.amount=e.amount}}class V extends R{constructor(e){super(e);this.id=e.car.id,this.make=e.car.make,this.model=e.car.model,this.year=e.car.year,this.description=e.car.description,this.price=e.car.price,this.color=e.car.color||"#ffffff",this.imgUrl=e.car.imgUrl,this.creatorId=e.car.creatorId,this.creator=e.car.creator||{}}}class j extends R{constructor(e){super(e);this.id=e.account.id,this.name=e.account.name,this.picture=e.account.picture}}const L=window.location.origin.includes("localhost"),H=L?"http://localhost:3000":"",Ae="mark-codeworks.us.auth0.com",Se="https://MarkDev.com",Ee="Qx0sMBfDbr9hZ916wAVJ6Y4ywBMBV9R2";function $(s,e){if(L)console[s](`[${s}] :: ${new Date().toLocaleTimeString()} :: `,...e);else{switch(s){case"log":case"assert":return}console[s](`[${s}] :: ${new Date().toLocaleTimeString()} :: `,...e)}}const d={log(){$("log",arguments)},error(){$("error",arguments)},warn(){$("warn",arguments)},assert(){$("assert",arguments)},trace(){$("trace",arguments)}},u=ee.create({baseURL:H,timeout:8e3});class Ie{async getBidsForAccount(){const e=await u.get("account/bids");d.log("accountBids",e.data),a.myBids=e.data.map(t=>new V(t))}async getBidsForCar(e){const t=await u.get(`api/cars/${e}/bids`);d.log("carBids",t.data),a.bids=t.data.map(o=>new j(o))}async create(e){const t=await u.post("api/bids",e);a.accountBids=new V(t.data),a.bids.unshift(new j(t.data))}async edit(e){await u.put("api/bids/"+e.bidId,e);const t=a.bids.findIndex(o=>o.bidId===e.bidId);a.bids.splice(t,1,e)}async remove(e){await u.delete("api/bids/"+e),a.bids=a.bids.filter(t=>t.bidId!==e)}}const E=new Ie;class b{static async confirm(e="Are you sure?",t="You won't be able to revert this!",o="warning",n="Yes, delete it!"){try{return!!(await D.fire({title:e,text:t,icon:o,showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:n})).isConfirmed}catch{return!1}}static toast(e="Warning!",t="warning",o="top-end",n=3e3,c=!0){D.fire({title:e,icon:t,position:o,timer:n,timerProgressBar:c,toast:!0,showConfirmButton:!1})}}const Te={setup(){const s=te();return oe(()=>{E.getBidsForCar(s.params.id)}),{car:v(()=>a.activeCar),account:v(()=>a.account),bids:v(()=>a.bids.sort((e,t)=>t.amount-e.amount)),hasBid:v(()=>!!a.bids.find(t=>t.accountId===a.account.id)),async bid(){try{const e={carId:s.params.id,accountId:a.account.id,amount:a.activeCar.price+250};await E.create(e),a.activeCar.price+=250,b.toast("Bid Added","success")}catch(e){d.error(e),b.toast("something went wrong","error")}},async bidAgain(e){try{e.amount+=250,await E.edit(e),a.activeCar.price+=250,b.toast("Increased Bid","success")}catch(t){d.error(t),b.toast("something went wrong","error")}},async withdraw(e){try{await E.remove(e),b.toast("withdrawn")}catch(t){d.error(t),b.toast("something went wrong","error")}}}}},Be={class:"row my-3 justify-content-center"},Pe={class:"col-md-8"},Oe={class:"bg-white rounded elevation-1 p-3"},Ue={class:"text-end p-3"},Me=["disabled","title"],De={key:0,class:"text-dark lighten-50"},qe={key:0},Ne=["onClick"],Re=["onClick"];function Ve(s,e,t,o,n,c){const l=k("CreatorDetails");return _(),p("div",Be,[r("div",Pe,[r("div",Oe,[r("div",Ue,[r("button",{class:"btn btn-success",onClick:e[0]||(e[0]=(...i)=>o.bid&&o.bid(...i)),disabled:!o.account.id||o.hasBid,title:o.account.id?"bid":"please login to bid"}," Bid: $"+y(o.car.price+250),9,Me)]),o.bids.length===0?(_(),p("h5",De," There are no bids yet ")):q("",!0),(_(!0),p(M,null,re(o.bids,(i,T)=>(_(),p("div",{key:i.id,class:"border border-primary rounded m-2 p-2 d-flex justify-content-between"},[h(l,{creator:i},null,8,["creator"]),r("p",null,"$"+y(i.amount),1),i.accountId==o.account.id&&T!=0?(_(),p("div",qe,[r("button",{class:"btn btn-sucess",onClick:G=>o.bidAgain(i)}," Increase Bid ",8,Ne),r("button",{class:"btn btn-danger",onClick:G=>o.withdraw(i.bidId)}," Withdraw ",8,Re)])):q("",!0)]))),128))])])])}var je=x(Te,[["render",Ve]]),Le=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:je});const He={props:{car:{type:Object,required:!0}},setup(){return{}}},ze={class:"mt-3 selectable"},Fe={class:"bg-light elevation-1 rounded"},Ye=["src"],Ke={class:"p-1 text-center"},We={class:"m-0"};function Ge(s,e,t,o,n,c){const l=k("router-link");return _(),p("div",ze,[h(l,{to:{name:"CarDetails",params:{id:t.car.id}}},{default:f(()=>[r("div",Fe,[r("img",{class:"car-img rounded-top w-100 img-fit",src:t.car.imgUrl,alt:"car image"},null,8,Ye),r("div",Ke,[r("p",We,[r("b",null,y(t.car.make)+" - "+y(t.car.model),1)])])])]),_:1},8,["to"])])}var Je=x(He,[["render",Ge],["__scopeId","data-v-d86a8764"]]),Qe=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:Je});class g{constructor(e={}){this.id=e.id,this.make=e.make,this.model=e.model,this.year=e.year,this.description=e.description,this.price=e.price,this.color=e.color||"#ffffff",this.imgUrl=e.imgUrl,this.creatorId=e.creatorId,this.creator=e.creator||{}}}class Ze{async getAll(e=""){const t=await u.get("api/cars"+e);d.log(t.data),a.cars=t.data.map(o=>new g(o))}async getById(e){const t=await u.get("api/cars/"+e);d.log(t.data),a.activeCar=new g(t.data)}async create(e){const t=await u.post("api/cars",e);d.log(t.data),a.cars.push(new g(t.data)),a.activeCar=new g(t.data)}async edit(e){const t=await u.put("api/cars/"+e.id,e);d.log(t.data);const o=new g(t.data);a.activeCar=o;const n=a.cars.findIndex(c=>c.id===o.id);if(n===-1){a.cars.push(o);return}a.cars.splice(n,1,o)}async remove(){const e=await u.delete("api/cars/"+a.activeCar.id);d.log(e.data),a.cars=a.cars.filter(t=>t.id!==a.activeCar.id),a.activeCar=new g}}const z=new Ze,Xe={props:{car:{type:g,default:()=>new g}},setup(s){const e=se(),t=ae({});return ne(()=>{t.value=U({},s.car)}),{editable:t,async handleSubmit(){try{t.value.id?await z.edit(t.value):await z.create(t.value),ie.getOrCreateInstance(document.getElementById("car-modal")).hide(),e.push({name:"CarDetails",params:{id:a.activeCar.id}})}catch(o){d.error(o),b.toast("Failed to Create","error")}}}}},et={class:"mb-3 d-flex justify-content-between"},tt=r("label",{for:"make",class:"form-label"},"Make",-1),ot=r("label",{for:"model",class:"form-label"},"Model",-1),rt={class:"mb-3 d-flex justify-content-between"},st=r("label",{for:"year",class:"form-label"},"Year",-1),at=r("label",{for:"color",class:"form-label"},"Color",-1),nt=r("label",{for:"price",class:"form-label"},"Price",-1),it={class:"mb-3"},ct=r("label",{for:"imgUrl",class:"form-label"},"Image Url",-1),lt={class:"mb-3"},dt=r("label",{for:"description",class:"form-label"},"Description",-1),ut={class:"modal-footer"},_t=r("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Close ",-1),mt={type:"submit",class:"btn btn-success"};function pt(s,e,t,o,n,c){const l=k("Modal");return _(),ce(l,{id:"car-modal"},{"modal-title":f(()=>[r("h4",null,y(t.car.id?"Edit":"Create")+" Car",1)]),"modal-body":f(()=>[r("form",{onSubmit:e[7]||(e[7]=le((...i)=>o.handleSubmit&&o.handleSubmit(...i),["prevent"]))},[r("div",et,[r("div",null,[tt,w(r("input",{type:"text",class:"form-control",name:"make",id:"make","aria-describedby":"make",placeholder:"Make...",required:"","onUpdate:modelValue":e[0]||(e[0]=i=>o.editable.make=i)},null,512),[[C,o.editable.make]])]),r("div",null,[ot,w(r("input",{type:"text",class:"form-control",name:"model",id:"model","aria-describedby":"model",placeholder:"Model...",required:"","onUpdate:modelValue":e[1]||(e[1]=i=>o.editable.model=i)},null,512),[[C,o.editable.model]])])]),r("div",rt,[r("div",null,[st,w(r("input",{type:"number",class:"form-control",name:"year",id:"year","aria-describedby":"year",placeholder:"Year...",min:"1950",max:"2022",required:"","onUpdate:modelValue":e[2]||(e[2]=i=>o.editable.year=i)},null,512),[[C,o.editable.year]])]),r("div",null,[at,w(r("input",{type:"color","onUpdate:modelValue":e[3]||(e[3]=i=>o.editable.color=i),class:"form-control",name:"color",id:"color","aria-describedby":"color",required:""},null,512),[[C,o.editable.color]])]),r("div",null,[nt,w(r("input",{type:"number",class:"form-control",name:"price",id:"price","aria-describedby":"price",placeholder:"Price...",min:"1",required:"","onUpdate:modelValue":e[4]||(e[4]=i=>o.editable.price=i)},null,512),[[C,o.editable.price]])])]),r("div",it,[r("div",null,[ct,w(r("input",{type:"url",class:"form-control",name:"imgUrl",id:"imgUrl","aria-describedby":"imgUrl",placeholder:"Image Url...",required:"","onUpdate:modelValue":e[5]||(e[5]=i=>o.editable.imgUrl=i)},null,512),[[C,o.editable.imgUrl]])])]),r("div",lt,[r("div",null,[dt,w(r("textarea",{type:"text",class:"form-control",name:"description",id:"description","aria-describedby":"description",placeholder:"Description...",min:"5",max:"250",required:"","onUpdate:modelValue":e[6]||(e[6]=i=>o.editable.description=i)},null,512),[[C,o.editable.description]])])]),r("div",ut,[_t,r("button",mt,y(t.car.id?"Save":"Create"),1)])],32)]),_:1})}var ht=x(Xe,[["render",pt]]),ft=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:ht});const bt={props:{creator:{type:Object,required:!0}}},gt={class:"user-tag d-flex align-items-center"},vt=["src"],yt={class:"m-0 ps-3"};function wt(s,e,t,o,n,c){return _(),p("div",gt,[r("img",{class:"rounded-pill",src:t.creator.picture,alt:""},null,8,vt),r("p",yt,y(t.creator.name),1)])}var Ct=x(bt,[["render",wt],["__scopeId","data-v-0a75e28e"]]),xt=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:Ct});const kt={},$t={class:"modal",tabindex:"-1"},At={class:"modal-dialog modal-xl"},St={class:"modal-content"},Et={class:"modal-header"},It={class:"modal-title"},Tt=r("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),Bt={class:"modal-body"};function Pt(s,e){return _(),p("div",$t,[r("div",At,[r("div",St,[r("div",Et,[r("h5",It,[N(s.$slots,"modal-title")]),Tt]),r("div",Bt,[N(s.$slots,"modal-body")])])])])}var Ot=x(kt,[["render",Pt]]),Ut=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:Ot});const Mt="modulepreload",F={},Dt="/",A=function(e,t){return!t||t.length===0?e():Promise.all(t.map(o=>{if(o=`${Dt}${o}`,o in F)return;F[o]=!0;const n=o.endsWith(".css"),c=n?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${o}"]${c}`))return;const l=document.createElement("link");if(l.rel=n?"stylesheet":Mt,n||(l.as="script",l.crossOrigin=""),l.href=o,document.head.appendChild(l),n)return new Promise((i,T)=>{l.addEventListener("load",i),l.addEventListener("error",T)})})).then(()=>e())};function qt(s){switch(s){case"./pages/AboutPage.vue":return A(()=>import("./AboutPage.838eae68.js"),["assets/AboutPage.838eae68.js","assets/vendor.0842eb63.js"]);case"./pages/AccountPage.vue":return A(()=>import("./AccountPage.21fbe2d5.js"),["assets/AccountPage.21fbe2d5.js","assets/AccountPage.3be04e1e.css","assets/vendor.0842eb63.js"]);case"./pages/CarDetailsPage.vue":return A(()=>import("./CarDetailsPage.2472a6f5.js"),["assets/CarDetailsPage.2472a6f5.js","assets/CarDetailsPage.8c856771.css","assets/vendor.0842eb63.js"]);case"./pages/CarsPage.vue":return A(()=>import("./CarsPage.ffd8ff44.js"),["assets/CarsPage.ffd8ff44.js","assets/vendor.0842eb63.js"]);case"./pages/HomePage.vue":return A(()=>import("./HomePage.a06f5f82.js"),["assets/HomePage.a06f5f82.js","assets/vendor.0842eb63.js"]);default:return new Promise(function(e,t){(typeof queueMicrotask=="function"?queueMicrotask:setTimeout)(t.bind(null,new Error("Unknown variable dynamic import: "+s)))})}}function I(s){return()=>qt(`./pages/${s}.vue`)}const Nt=[{path:"/",name:"Home",component:I("HomePage")},{path:"/cars",name:"Cars",component:I("CarsPage")},{path:"/cars/:id",name:"CarDetails",component:I("CarDetailsPage")},{path:"/account",name:"Account",component:I("AccountPage"),beforeEnter:_e}],Y=de({linkActiveClass:"router-link-active",linkExactActiveClass:"router-link-exact-active",history:ue(),routes:Nt});class Rt{async getAccount(){try{const e=await u.get("/account");a.account=e.data}catch(e){d.error("HAVE YOU STARTED YOUR SERVER YET???",e)}}}const Vt=new Rt,jt={connection:"connection",connected:"connected",disconnect:"disconnect",authenticate:"authenticate",authenticated:"authenticated",userConnected:"userConnected",userDisconnected:"userDisconnected",error:"error"};class Lt{constructor(e=!1,t=H){}on(e,t){var o;return(o=this.socket)==null||o.on(e,t.bind(this)),this}onConnected(e){d.log("[SOCKET_CONNECTION]",e),this.connected=!0,this.playback()}onAuthenticated(e){d.log("[SOCKET_AUTHENTICATED]",e),this.authenticated=!0,this.playback()}authenticate(e){var t;(t=this.socket)==null||t.emit(jt.authenticate,e)}onError(e){d.error("[SOCKET_ERROR]",e)}enqueue(e,t){d.log("[ENQUEING_ACTION]",{action:e,payload:t}),this.queue.push({action:e,payload:t})}playback(){d.log("[SOCKET_PLAYBACK]");const e=[...this.queue];this.queue=[],e.forEach(t=>{this.emit(t.action,t.payload)})}emit(e,t=void 0){if(this.requiresAuth&&!this.authenticated)return this.enqueue(e,t);if(!this.connected)return this.enqueue(e,t);this.socket.emit(e,t)}}class Ht extends Lt{constructor(){super();this.on("error",this.onError)}onError(e){b.toast(e.message,"error")}}const K=new Ht,m=me({domain:Ae,clientId:Ee,audience:Se,useRefreshTokens:!0,onRedirectCallback:s=>{Y.push(s&&s.targetUrl?s.targetUrl:window.location.pathname)}});m.on(m.AUTH_EVENTS.AUTHENTICATED,async function(){u.defaults.headers.authorization=m.bearer,u.interceptors.request.use(zt),a.user=m.user,await Vt.getAccount(),K.authenticate(m.bearer)});async function zt(s){if(!m.isAuthenticated)return s;const e=m.identity.exp*1e3,t=e<Date.now(),o=e<Date.now()+1e3*60*60*12;return t?await m.loginWithPopup():o&&(await m.getTokenSilently(),u.defaults.headers.authorization=m.bearer,K.authenticate(m.bearer)),s}var Ft="/assets/GregsList.386a5b7b.svg";const Yt={setup(){return{user:v(()=>a.user),account:v(()=>a.account),async login(){m.loginWithPopup()},async logout(){m.logout({returnTo:window.location.origin})}}}},B=s=>(pe("data-v-2a0d9c6d"),s=s(),he(),s),Kt={class:"bg-success p-3 h-100 d-flex flex-column"},Wt=B(()=>r("img",{class:"img-fluid",alt:"logo",src:Ft},null,-1)),Gt={class:"d-flex flex-column justify-content-between flex-grow-1"},Jt={class:"navbar-nav mt-5 w-100"},Qt={class:"d-flex flex-column"},Zt=S(" Cars "),Xt=S(" Houses "),eo=S(" Jobs "),to={key:1,class:"my-1"},oo={class:"dropdown-toggle selectable","data-bs-toggle":"dropdown","aria-expanded":"false",id:"authDropdown"},ro=["src"],so={class:"dropdown-menu p-0 list-group","aria-labelledby":"authDropdown"},ao=B(()=>r("div",{class:"list-group-item list-group-item-action hoverable"}," Manage Account ",-1)),no=B(()=>r("i",{class:"mdi mdi-logout"},null,-1)),io=S(" logout "),co=[no,io];function lo(s,e,t,o,n,c){const l=k("router-link");return _(),p("nav",Kt,[h(l,{class:"d-flex",to:{name:"Home"}},{default:f(()=>[Wt]),_:1}),r("div",Gt,[r("ul",Jt,[r("li",Qt,[h(l,{to:{name:"Cars"},class:"btn selectable text-uppercase"},{default:f(()=>[Zt]),_:1}),h(l,{to:{name:"Home"},class:"btn selectable text-uppercase"},{default:f(()=>[Xt]),_:1}),h(l,{to:{name:"Home"},class:"btn selectable text-uppercase"},{default:f(()=>[eo]),_:1})])]),r("span",null,[o.user.isAuthenticated?(_(),p("div",to,[r("div",oo,[r("img",{src:o.account.picture,alt:"user photo",height:"40",class:"rounded"},null,8,ro)]),r("div",so,[h(l,{to:{name:"Account"}},{default:f(()=>[ao]),_:1}),r("div",{class:"list-group-item list-group-item-action hoverable text-danger",onClick:e[1]||(e[1]=(...i)=>o.logout&&o.logout(...i))},co)])])):(_(),p("button",{key:0,class:"btn selectable text-success lighten-30 text-uppercase my-1",onClick:e[0]||(e[0]=(...i)=>o.login&&o.login(...i))}," Login "))])])])}var uo=x(Yt,[["render",lo],["__scopeId","data-v-2a0d9c6d"]]),_o=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:uo});function mo(s){Object.entries({"./components/Bids.vue":Le,"./components/Car.vue":Qe,"./components/CarFormModal.vue":ft,"./components/CreatorDetails.vue":xt,"./components/Modal.vue":Ut,"./components/Navbar.vue":_o}).forEach(([t,o])=>{const n=o.name||t.substr(t.lastIndexOf("/")+1).replace(/\.\w+$/,"");s.component(n,o.default)})}const W=fe($e);mo(W);W.use(Y).mount("#app");export{m as A,b as P,x as _,a,E as b,z as c,d as l};
